services:
  - type: pg
    name: stefanos-db
    region: oregon
    plan: free
    # PostgreSQL database - fully managed by Render
    # Connection string will be automatically available as DATABASE_URL

  - type: web
    name: stefanos-backend
    env: node
    region: oregon
    plan: free
    buildCommand: npm install --include=dev && npx prisma generate && npm run build && npx prisma migrate deploy
    startCommand: npm run start:prod
    envVars:
      - key: NODE_ENV
        value: production
      # DATABASE_URL is automatically set by Render from the PostgreSQL service above
      # Add other environment variables in Render Dashboard:
      # JWT_SECRET, FRONTEND_URL, etc.
      # Or uncomment and set them here:
      # - key: JWT_SECRET
      #   sync: false
      # - key: FRONTEND_URL
      #   sync: false
      # - key: ADMIN_URL
      #   sync: false
      # - key: SMTP_HOST
      #   sync: false
      # - key: SMTP_PORT
      #   sync: false
      # - key: SMTP_USER
      #   sync: false
      # - key: SMTP_PASS
      #   sync: false
      # - key: CLOUDINARY_CLOUD_NAME
      #   sync: false
      # - key: CLOUDINARY_API_KEY
      #   sync: false
      # - key: CLOUDINARY_API_SECRET
      #   sync: false
      # - key: STRIPE_SECRET_KEY
      #   sync: false
      # - key: STRIPE_WEBHOOK_SECRET
      #   sync: false
      # - key: REDIS_URL
      #   sync: false
